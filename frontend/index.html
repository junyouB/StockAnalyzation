<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‚¡ç¥¨æŠ€æœ¯åˆ†æå·¥å…·</title>
    <!-- å¼•å…¥å¤–éƒ¨åº“ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .card {
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .signal-buy {
            color: #28a745;
            font-weight: bold;
        }
        .signal-sell {
            color: #dc3545;
            font-weight: bold;
        }
        .signal-hold {
            color: #ffc107;
            font-weight: bold;
        }
        .chart-container {
            height: 400px;
            position: relative;
        }
        .metric-card {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        .metric-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        .btn-primary {
            background-color: #667eea;
            border-color: #667eea;
        }
        .btn-primary:hover {
            background-color: #5a6fd8;
            border-color: #5a6fd8;
        }
    </style>
</head>
<body>
    <!-- å¤´éƒ¨ -->
    <header class="header text-center">
        <div class="container">
            <h1 class="display-4">ğŸ“ˆ è‚¡ç¥¨æŠ€æœ¯åˆ†æå·¥å…·</h1>
            <p class="lead">ä¸“ä¸šçš„è‚¡ç¥¨æŠ€æœ¯åˆ†æï¼ŒåŠ©æ‚¨åšå‡ºæ˜æ™ºçš„æŠ•èµ„å†³ç­–</p>
        </div>
    </header>

    <!-- ä¸»å†…å®¹ -->
    <div class="container mb-5">
        <!-- æœç´¢å’Œå‚æ•°è®¾ç½® -->
        <div class="card mb-4">
            <div class="card-body">
                <h2 class="card-title mb-4">å‚æ•°è®¾ç½®</h2>
                <form id="analysis-form">
                    <div class="row g-3">
                        <!-- è‚¡ç¥¨ä»£ç  -->
                        <div class="col-md-4">
                            <label for="symbol" class="form-label">è‚¡ç¥¨ä»£ç </label>
                            <input type="text" class="form-control" id="symbol" placeholder="ä¾‹å¦‚: AAPL, MSFT, GOOGL" value="AAPL">
                        </div>
                        <!-- æ—¶é—´å‘¨æœŸ -->
                        <div class="col-md-3">
                            <label for="period" class="form-label">æ—¶é—´å‘¨æœŸ</label>
                            <select class="form-select" id="period">
                                <option value="1d">1å¤©</option>
                                <option value="5d">5å¤©</option>
                                <option value="1mo">1ä¸ªæœˆ</option>
                                <option value="3mo">3ä¸ªæœˆ</option>
                                <option value="6mo">6ä¸ªæœˆ</option>
                                <option value="1y" selected>1å¹´</option>
                                <option value="2y">2å¹´</option>
                                <option value="5y">5å¹´</option>
                                <option value="10y">10å¹´</option>
                                <option value="max">æœ€å¤§</option>
                            </select>
                        </div>
                        <!-- æ•°æ®é—´éš” -->
                        <div class="col-md-3">
                            <label for="interval" class="form-label">æ•°æ®é—´éš”</label>
                            <select class="form-select" id="interval">
                                <option value="1m">1åˆ†é’Ÿ</option>
                                <option value="5m">5åˆ†é’Ÿ</option>
                                <option value="15m">15åˆ†é’Ÿ</option>
                                <option value="30m">30åˆ†é’Ÿ</option>
                                <option value="1h">1å°æ—¶</option>
                                <option value="1d" selected>1å¤©</option>
                                <option value="1wk">1å‘¨</option>
                                <option value="1mo">1ä¸ªæœˆ</option>
                            </select>
                        </div>
                        <!-- åˆ†ææŒ‰é’® -->
                        <div class="col-md-2 d-flex align-items-end">
                            <button type="submit" class="btn btn-primary w-100">å¼€å§‹åˆ†æ</button>
                        </div>
                    </div>
                    
                    <!-- æŒ‡æ ‡é€‰æ‹© -->
                    <div class="row g-3 mt-4">
                        <div class="col-md-12">
                            <h3 class="h5">æŒ‡æ ‡é€‰æ‹©</h3>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="show-ma" checked>
                                <label class="form-check-label" for="show-ma">ç§»åŠ¨å¹³å‡çº¿</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="show-macd" checked>
                                <label class="form-check-label" for="show-macd">MACD</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="show-rsi" checked>
                                <label class="form-check-label" for="show-rsi">RSI</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="show-bollinger" checked>
                                <label class="form-check-label" for="show-bollinger">å¸ƒæ—å¸¦</label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div id="loading" class="alert alert-info text-center mb-4" style="display: none;">
            <h4 class="alert-heading">æ­£åœ¨åˆ†ææ•°æ®...</h4>
            <p>è¯·ç¨å€™ï¼Œæ­£åœ¨è·å–è‚¡ç¥¨æ•°æ®å¹¶è®¡ç®—æŠ€æœ¯æŒ‡æ ‡</p>
        </div>

        <!-- ä¿¡å·æç¤º -->
        <div id="signal-alert" class="alert mb-4" style="display: none;"></div>

        <!-- æ•°æ®æ¦‚è§ˆ -->
        <div id="data-overview" class="row g-3 mb-4" style="display: none;">
            <div class="col-md-2">
                <div class="metric-card">
                    <div class="metric-label">æœ€æ–°ä»·æ ¼</div>
                    <div class="metric-value" id="latest-price"></div>
                    <div id="price-change" class="small"></div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="metric-card">
                    <div class="metric-label">å¼€ç›˜ä»·</div>
                    <div class="metric-value" id="open-price"></div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="metric-card">
                    <div class="metric-label">æœ€é«˜ä»·</div>
                    <div class="metric-value" id="high-price"></div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="metric-card">
                    <div class="metric-label">æœ€ä½ä»·</div>
                    <div class="metric-value" id="low-price"></div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="metric-card">
                    <div class="metric-label">æˆäº¤é‡</div>
                    <div class="metric-value" id="volume"></div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="metric-card">
                    <div class="metric-label">æœ€æ–°ä¿¡å·</div>
                    <div class="metric-value" id="latest-signal"></div>
                </div>
            </div>
        </div>

        <!-- å›¾è¡¨åŒºåŸŸ -->
        <div class="row mb-4">
            <!-- Kçº¿å›¾ -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Kçº¿å›¾</h3>
                    </div>
                    <div class="card-body">
                        <div id="candlestick-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <!-- æŠ€æœ¯æŒ‡æ ‡ -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">æŠ€æœ¯æŒ‡æ ‡</h3>
                    </div>
                    <div class="card-body">
                        <div id="indicators-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¿¡å·åˆ†æ -->
        <div class="card mb-4" id="signal-analysis" style="display: none;">
            <div class="card-header">
                <h3 class="card-title">ä¿¡å·åˆ†æ</h3>
            </div>
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="metric-card text-center">
                            <div class="metric-label">ä¹°å…¥ä¿¡å·</div>
                            <div class="metric-value" id="buy-signals"></div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card text-center">
                            <div class="metric-label">å–å‡ºä¿¡å·</div>
                            <div class="metric-value" id="sell-signals"></div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card text-center">
                            <div class="metric-label">æŒæœ‰ä¿¡å·</div>
                            <div class="metric-value" id="hold-signals"></div>
                        </div>
                    </div>
                </div>
                <h4 class="mb-3">æœ€è¿‘ä¿¡å·å†å²</h4>
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>ä»·æ ¼</th>
                                <th>ä¿¡å·</th>
                            </tr>
                        </thead>
                        <tbody id="signal-history"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- åŸå§‹æ•°æ® -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">åŸå§‹æ•°æ®</h3>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>å¼€ç›˜ä»·</th>
                                <th>æœ€é«˜ä»·</th>
                                <th>æœ€ä½ä»·</th>
                                <th>æ”¶ç›˜ä»·</th>
                                <th>æˆäº¤é‡</th>
                            </tr>
                        </thead>
                        <tbody id="data-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡µè„š -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container text-center">
            <p>Â© 2024 è‚¡ç¥¨æŠ€æœ¯åˆ†æå·¥å…· | æ•°æ®æ¥æº: Yahoo Finance</p>
            <p class="small">æœ¬å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // æ¨¡æ‹Ÿæ•°æ®
        const mockData = {
            symbol: "AAPL",
            prices: [180, 182, 178, 185, 190, 188, 195, 200, 198, 205],
            dates: ["2024-01-01", "2024-01-02", "2024-01-03", "2024-01-04", "2024-01-05", "2024-01-06", "2024-01-07", "2024-01-08", "2024-01-09", "2024-01-10"],
            open: [179, 181, 183, 177, 184, 189, 187, 194, 199, 197],
            high: [181, 183, 180, 186, 191, 189, 196, 201, 199, 206],
            low: [178, 180, 177, 184, 189, 187, 194, 199, 197, 204],
            close: [180, 182, 178, 185, 190, 188, 195, 200, 198, 205],
            volume: [1000000, 1200000, 900000, 1500000, 1800000, 1300000, 1600000, 2000000, 1400000, 1900000],
            signals: [0, 1, -1, 0, 1, 0, 1, 0, -1, 1]
        };

        // åˆå§‹åŒ–å›¾è¡¨
        let candlestickChart = null;
        let indicatorsChart = null;

        // è¡¨å•æäº¤äº‹ä»¶
        document.getElementById('analysis-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loading').style.display = 'block';
            document.getElementById('signal-alert').style.display = 'none';
            document.getElementById('data-overview').style.display = 'none';
            document.getElementById('signal-analysis').style.display = 'none';

            // è·å–è¡¨å•æ•°æ®
            const symbol = document.getElementById('symbol').value;
            const period = document.getElementById('period').value;
            const interval = document.getElementById('interval').value;
            const showMA = document.getElementById('show-ma').checked;
            const showMACD = document.getElementById('show-macd').checked;
            const showRSI = document.getElementById('show-rsi').checked;
            const showBollinger = document.getElementById('show-bollinger').checked;

            // æ¨¡æ‹ŸAPIè¯·æ±‚å»¶è¿Ÿ
            setTimeout(() => {
                // éšè—åŠ è½½çŠ¶æ€
                document.getElementById('loading').style.display = 'none';
                
                // æ˜¾ç¤ºç»“æœ
                displayResults(symbol);
                renderCharts();
                renderDataTable();
                renderSignalAnalysis();
            }, 1500);
        });

        // æ˜¾ç¤ºç»“æœ
        function displayResults(symbol) {
            // è®¡ç®—æ¶¨è·Œå¹…
            const latestPrice = mockData.close[mockData.close.length - 1];
            const prevPrice = mockData.close[mockData.close.length - 2];
            const change = latestPrice - prevPrice;
            const changePercent = (change / prevPrice) * 100;

            // æ›´æ–°æ•°æ®æ¦‚è§ˆ
            document.getElementById('latest-price').textContent = `$${latestPrice.toFixed(2)}`;
            document.getElementById('price-change').textContent = `${change > 0 ? '+' : ''}${change.toFixed(2)} (${changePercent > 0 ? '+' : ''}${changePercent.toFixed(2)}%)`;
            document.getElementById('price-change').className = `small ${change >= 0 ? 'text-success' : 'text-danger'}`;
            document.getElementById('open-price').textContent = `$${mockData.open[mockData.open.length - 1].toFixed(2)}`;
            document.getElementById('high-price').textContent = `$${mockData.high[mockData.high.length - 1].toFixed(2)}`;
            document.getElementById('low-price').textContent = `$${mockData.low[mockData.low.length - 1].toFixed(2)}`;
            document.getElementById('volume').textContent = mockData.volume[mockData.volume.length - 1].toLocaleString();

            // è·å–æœ€æ–°ä¿¡å·
            const latestSignal = mockData.signals[mockData.signals.length - 1];
            let signalText = '';
            let signalClass = '';
            let alertClass = '';

            switch(latestSignal) {
                case 1:
                    signalText = 'ä¹°å…¥';
                    signalClass = 'signal-buy';
                    alertClass = 'alert-success';
                    break;
                case -1:
                    signalText = 'å–å‡º';
                    signalClass = 'signal-sell';
                    alertClass = 'alert-danger';
                    break;
                default:
                    signalText = 'æŒæœ‰';
                    signalClass = 'signal-hold';
                    alertClass = 'alert-warning';
            }

            // æ˜¾ç¤ºä¿¡å·
            document.getElementById('latest-signal').textContent = signalText;
            document.getElementById('latest-signal').className = `metric-value ${signalClass}`;

            // æ˜¾ç¤ºä¿¡å·è­¦æŠ¥
            const signalAlert = document.getElementById('signal-alert');
            signalAlert.className = `alert ${alertClass} mb-4`;
            signalAlert.innerHTML = `<strong>${signalText}ä¿¡å·</strong> - è‚¡ç¥¨ ${symbol} ç›®å‰å¤„äº${signalText}åŒºé—´`;
            signalAlert.style.display = 'block';

            // æ˜¾ç¤ºæ•°æ®æ¦‚è§ˆ
            document.getElementById('data-overview').style.display = 'flex';
        }

        // æ¸²æŸ“å›¾è¡¨
        function renderCharts() {
            // æ¸²æŸ“Kçº¿å›¾
            renderCandlestickChart();
            // æ¸²æŸ“æŒ‡æ ‡å›¾
            renderIndicatorsChart();
        }

        // æ¸²æŸ“Kçº¿å›¾
        function renderCandlestickChart() {
            const chartDom = document.getElementById('candlestick-chart');
            candlestickChart = echarts.init(chartDom);

            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross'
                    }
                },
                grid: {
                    left: '10%',
                    right: '10%',
                    bottom: '15%'
                },
                xAxis: {
                    type: 'category',
                    data: mockData.dates,
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    scale: true
                },
                series: [{
                    name: 'Kçº¿',
                    type: 'candlestick',
                    data: mockData.dates.map((date, index) => [
                        mockData.open[index],
                        mockData.close[index],
                        mockData.low[index],
                        mockData.high[index]
                    ]),
                    itemStyle: {
                        color: '#28a745',
                        color0: '#dc3545',
                        borderColor: '#28a745',
                        borderColor0: '#dc3545'
                    }
                }]
            };

            candlestickChart.setOption(option);
        }

        // æ¸²æŸ“æŒ‡æ ‡å›¾
        function renderIndicatorsChart() {
            const chartDom = document.getElementById('indicators-chart');
            indicatorsChart = echarts.init(chartDom);

            // è®¡ç®—æ¨¡æ‹ŸRSI
            const rsi = [];
            for (let i = 0; i < mockData.prices.length; i++) {
                rsi.push(50 + Math.sin(i) * 30);
            }

            const option = {
                tooltip: {
                    trigger: 'axis'
                },
                grid: {
                    left: '10%',
                    right: '10%',
                    bottom: '15%'
                },
                xAxis: {
                    type: 'category',
                    data: mockData.dates,
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    min: 0,
                    max: 100,
                    axisLabel: {
                        formatter: '{value}'
                    }
                },
                series: [{
                    name: 'RSI',
                    type: 'line',
                    data: rsi,
                    smooth: true,
                    lineStyle: {
                        color: '#667eea'
                    },
                    areaStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: 'rgba(102, 126, 234, 0.5)' },
                            { offset: 1, color: 'rgba(102, 126, 234, 0.1)' }
                        ])
                    }
                }]
            };

            indicatorsChart.setOption(option);
        }

        // æ¸²æŸ“æ•°æ®è¡¨æ ¼
        function renderDataTable() {
            const tbody = document.getElementById('data-table');
            tbody.innerHTML = '';

            // æ˜¾ç¤ºæœ€è¿‘10æ¡æ•°æ®
            const recentData = mockData.dates.slice(-10).map((date, index) => {
                const dataIndex = mockData.dates.length - 10 + index;
                return {
                    date: date,
                    open: mockData.open[dataIndex],
                    high: mockData.high[dataIndex],
                    low: mockData.low[dataIndex],
                    close: mockData.close[dataIndex],
                    volume: mockData.volume[dataIndex]
                };
            });

            recentData.forEach(data => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${data.date}</td>
                    <td>$${data.open.toFixed(2)}</td>
                    <td>$${data.high.toFixed(2)}</td>
                    <td>$${data.low.toFixed(2)}</td>
                    <td>$${data.close.toFixed(2)}</td>
                    <td>${data.volume.toLocaleString()}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // æ¸²æŸ“ä¿¡å·åˆ†æ
        function renderSignalAnalysis() {
            // ç»Ÿè®¡ä¿¡å·
            const signalCounts = {
                buy: mockData.signals.filter(s => s === 1).length,
                sell: mockData.signals.filter(s => s === -1).length,
                hold: mockData.signals.filter(s => s === 0).length
            };

            // æ›´æ–°ä¿¡å·è®¡æ•°
            document.getElementById('buy-signals').textContent = signalCounts.buy;
            document.getElementById('sell-signals').textContent = signalCounts.sell;
            document.getElementById('hold-signals').textContent = signalCounts.hold;

            // æ¸²æŸ“ä¿¡å·å†å²
            const tbody = document.getElementById('signal-history');
            tbody.innerHTML = '';

            // æ˜¾ç¤ºæœ€è¿‘10æ¡ä¿¡å·
            const recentSignals = mockData.dates.slice(-10).map((date, index) => {
                const dataIndex = mockData.dates.length - 10 + index;
                return {
                    date: date,
                    price: mockData.close[dataIndex],
                    signal: mockData.signals[dataIndex]
                };
            });

            recentSignals.forEach(signal => {
                let signalText = '';
                let signalClass = '';

                switch(signal.signal) {
                    case 1:
                        signalText = 'ä¹°å…¥';
                        signalClass = 'signal-buy';
                        break;
                    case -1:
                        signalText = 'å–å‡º';
                        signalClass = 'signal-sell';
                        break;
                    default:
                        signalText = 'æŒæœ‰';
                        signalClass = 'signal-hold';
                }

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${signal.date}</td>
                    <td>$${signal.price.toFixed(2)}</td>
                    <td class="${signalClass}">${signalText}</td>
                `;
                tbody.appendChild(row);
            });

            // æ˜¾ç¤ºä¿¡å·åˆ†æ
            document.getElementById('signal-analysis').style.display = 'block';
        }

        // çª—å£å¤§å°æ”¹å˜æ—¶é‡ç»˜å›¾è¡¨
        window.addEventListener('resize', function() {
            if (candlestickChart) {
                candlestickChart.resize();
            }
            if (indicatorsChart) {
                indicatorsChart.resize();
            }
        });
    </script>
</body>
</html>