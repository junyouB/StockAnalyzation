# StockAnalyzation - 智能股票形态匹配与分析系统

## 📖 项目简介
StockAnalyzation 是一个集成了**交互式形态匹配**、**AI 智能分析**、**多维技术指标**和**个性化收藏管理**的综合性股票分析平台。它不仅允许用户通过手绘曲线来搜索历史走势相似的股票，还内置了基于规则引擎的 AI 分析报告功能，帮助投资者全方位洞察市场机会。

项目采用前后端分离架构，结合了高效的算法引擎、实时数据跟踪与直观的 Web 可视化界面。

---

## 🛠 功能层 (Functional Layer)
本项目为用户提供了以下核心功能：

### 1. 交互式曲线匹配 (Draw-to-Search)
- **手绘模式**：用户可以在 HTML5 Canvas 画布上自由绘制预期的股价走势（如“V型反转”、“头肩底”）。
- **智能匹配**：系统通过 KD-Tree 和 DTW 算法实时计算，在全市场数千只股票中找到与手绘曲线形态最相似的 Top 3 股票（Match 1, 2, 3）。
- **快捷操作**：支持一键复制匹配股票代码，或直接将其加入收藏架。

### 2. AI 智能分析报告 (AI Smart Analysis)
- **一键诊断**：点击侧边栏的“AI 智能分析”按钮，系统会自动生成当前股票的深度分析报告。
- **多维评估**：
  - **趋势判断**：自动识别短期（20日）、中期（60日）、长期（120日）的价格趋势（上涨/下跌/震荡）。
  - **关键位分析**：自动计算支撑位与阻力位。
  - **信号捕捉**：智能识别 MACD 金叉/死叉、RSI 超买/超卖、KDJ 信号等关键交易时机。

### 3. 专业级技术指标 (Technical Indicators)
系统内置了丰富的技术指标计算与展示功能，辅助用户进行技术面分析：
- **均线系统 (MA)**：MA5, MA10, MA20, MA30, MA60 多周期均线。
- **成交量 (VOL)**：量价配合分析。
- **MACD**：指数平滑异同移动平均线，判断动能强弱。
- **KDJ**：随机指标，捕捉超买超卖信号。
- **RSI**：相对强弱指标，辅助判断市场情绪。
- **BOLL**：布林带指标，分析价格波动区间。
*注：页面内置了详细的“技术指标参考指南”，帮助新手用户快速理解各指标含义。*

### 4. 个性化收藏架 (Favorites Shelf)
- **常驻侧边栏**：页面右上角提供常驻折叠式收藏架，方便随时查看关注列表。
- **持久化存储**：采用 **LocalStorage** 技术，无需登录即可在本地浏览器长期保存收藏数据。
- **数据迁移**：支持将收藏列表导出为 `.json` 文件，或从文件导入，实现数据备份与跨设备迁移。

### 5. 全自动化数据运维
- **后台跟踪**：内置 `stock_tracker` 服务，自动通过 BaoStock 接口抓取并增量更新全市场股票数据。
- **一键启动**：通过 `start.sh` 脚本即可一键拉起所有依赖服务。

---

## 🏗 技术层 (Technical Layer)
项目采用轻量级、模块化的技术栈：

### 前端 (Frontend)
- **核心技术**：原生 HTML5 / CSS3 / JavaScript (ES6+)，响应式布局。
- **可视化引擎**：
  - **ECharts**：渲染高性能 K 线图与技术指标子图。
  - **HTML5 Canvas**：实现丝滑的手绘交互体验。
- **交互逻辑**：DOM 操作、事件驱动、Fetch API 异步通信。

### 后端 (Backend)
- **语言**：Python 3.10+
- **Web 框架**：Flask (RESTful API 设计)。
- **数据分析**：
  - **NumPy / Pandas**：高效处理大规模时间序列数据与指标计算。
  - **SciPy**：辅助科学计算。

### 核心算法 (Algorithms)
- **KD-Tree**：自定义实现的 KD-Tree 索引结构，用于在高维特征空间中快速筛选候选股票。
- **DTW (Dynamic Time Warping)**：动态时间规整算法，精准计算手绘曲线与历史走势的形态相似度。
- **规则引擎**：基于经典技术分析理论（如金叉死叉、趋势定义）构建的自动分析逻辑。

---

## 🌐 网络层 (Network Layer)
项目采用微服务式的端口分离架构，各组件通过 HTTP 协议协作：

| 服务名称 | 端口 | 职责 |
| :--- | :--- | :--- |
| **Frontend** | `:8000` | 提供静态资源与用户界面 |
| **Data API** | `:5001` | 提供基础股票数据查询、AI 分析报告生成 |
| **Similarity API** | `:5002` | 提供高算力的曲线匹配服务 |
| **Tracker** | `(后台)` | 独立进程，负责与外部数据源 (BaoStock) 通信 |

- **CORS 策略**：后端服务配置了跨域资源共享，允许前端跨端口调用 API。

---

## 💡 用户价值 (User Benefits)
1. **所见即所得**：打破传统选股模式，通过画图直接表达投资直觉。
2. **智能辅助**：AI 报告与多维指标为决策提供客观的数据支持，减少主观情绪干扰。
3. **私有化部署**：数据与分析过程完全运行在本地，保护用户隐私与策略安全。
4. **一站式体验**：从发现（匹配）到分析（AI/指标）再到管理（收藏），覆盖投资分析全流程。

---

## 🚀 快速开始
```bash
# 1. 赋予脚本执行权限
chmod +x start.sh

# 2. 一键启动所有服务
./start.sh
```
启动后访问：`http://localhost:8000`

---

## 🔮 未来发展方向 (Future Roadmap)
1. **大模型接入 (LLM Integration)**：接入 GPT/DeepSeek 等大语言模型，基于技术指标生成更自然、更具深度的行情解读与投资建议，实现真正的“AI 投顾”对话。
2. **实时数据流 (WebSocket)**：升级网络层，支持毫秒级行情推送，实现盘中实时预警。
3. **策略回测系统**：允许用户对匹配到的形态或技术指标组合进行历史回测，验证策略的有效性与盈亏比。
4. **基本面筛选**：引入 PE、PB、ROE 等财务指标，实现“技术面+基本面”的双重过滤。
5. **云端账户体系**：支持多端同步收藏数据与分析记录。
